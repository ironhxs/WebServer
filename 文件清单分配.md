# WebServer 项目文件清单分配

## 📂 你需要负责的文件 (63%)

### 1️⃣ 核心服务器架构 (20%)

**主要目录**: `src/core/`, `include/`

**核心文件**:
```
src/core/
├── webserver.cpp          ⭐ 核心文件 (655行) - Epoll事件循环、信号处理
├── config.cpp             ⭐ 配置管理 - 命令行参数解析
└── main.cpp               ⭐ 程序入口

include/
├── webserver.h            ⭐ WebServer类定义
└── config.h               ⭐ Config类定义
```

**重点代码**:
- `WebServer::eventLoop()` - 事件循环主逻辑
- `WebServer::dealwithevent()` - 事件处理分发
- `WebServer::dealwithsignal()` - 信号处理
- `WebServer::timer()` - 定时器触发

---

### 2️⃣ HTTP协议处理 (15%)

**主要目录**: `src/http/`, `include/`

**核心文件**:
```
src/http/
└── http_connection.cpp    ⭐⭐ 最核心文件 (1500+行)

include/
└── http_connection.h      ⭐⭐ HTTP连接类定义
```

**重点代码**:
- `http_conn::process_read()` - HTTP请求解析状态机
- `http_conn::parse_request_line()` - 请求行解析
- `http_conn::parse_headers()` - 请求头解析
- `http_conn::parse_content()` - 请求体解析
- `http_conn::process_write()` - HTTP响应生成
- `http_conn::do_request()` - 请求处理逻辑
- 文件上传处理 (multipart/form-data)
- PHP-CGI接口调用
- 状态监控JSON接口

---

### 3️⃣ 线程池与并发模型 (10%)

**主要目录**: `include/`

**核心文件**:
```
include/
├── threadpool.h           ⭐ 线程池模板类 (重要！)
└── thread_sync.h          🔧 线程同步工具 (信号量、锁、条件变量)
```

**重点代码**:
- `threadpool::threadpool()` - 线程池构造函数
- `threadpool::run()` - 工作线程函数
- `threadpool::append()` - 任务添加到队列
- Reactor模式实现
- Proactor模式实现

---

### 4️⃣ 日志系统 (8%)

**主要目录**: `src/log/`, `include/`

**核心文件**:
```
src/log/
└── log.cpp                ⭐ 日志系统实现

include/
├── log.h                  ⭐ Log类定义
└── blocking_queue.h       ⭐ 阻塞队列 (异步日志核心)
```

**重点代码**:
- `Log::write_log()` - 日志写入
- `Log::async_write_log()` - 异步写入线程函数
- `block_queue` 模板类 - 生产者消费者队列
- 日志分割逻辑
- 缓冲区管理

---

### 5️⃣ Web前端资源 (10%)

**主要目录**: `resources/webroot/`

**核心文件**:
```
resources/webroot/
├── index.html             ⭐ 首页 (需要设计美观)
├── 404.html               🔧 错误页面
├── demo.html              📝 演示页面
├── phpinfo.php            🔧 PHP测试页面
│
├── pages/                 ⭐ 功能页面目录
│   ├── log.html           ⭐ 登录页面
│   ├── register.html      ⭐ 注册页面
│   ├── upload.html        ⭐ 文件上传页面
│   ├── status.html        ⭐ 服务器监控页面
│   ├── welcome.html       🔧 欢迎页面
│   └── ...                📁 其他页面
│
├── assets/                ⭐ 静态资源
│   ├── css/               ⭐ 样式文件
│   │   └── style.css
│   ├── js/                ⭐ JavaScript文件
│   │   └── main.js
│   ├── images/            ⭐ 图片资源
│   └── media/             📁 媒体文件
│
└── uploads/               📁 上传文件存储目录
```

**重点工作**:
- 设计美观的响应式页面
- 实现用户交互逻辑 (Ajax)
- 表单验证和提交
- 文件上传界面
- 服务器状态监控可视化
- CSS样式统一设计
- 跨浏览器兼容

---

## 📂 同学需要负责的文件 (37%)

### 1️⃣ 数据库连接池 (12%)

**主要目录**: `src/database/`, `include/`, `config/`

**核心文件**:
```
src/database/
└── database_pool.cpp      ⭐ 数据库连接池实现

include/
└── database_pool.h        ⭐ 连接池类定义

config/
└── setup_db.sql           ⭐ 数据库初始化脚本
```

**重点代码**:
- `connection_pool::GetInstance()` - 单例模式
- `connection_pool::init()` - 连接池初始化
- `connection_pool::GetConnection()` - 获取连接
- `connection_pool::ReleaseConnection()` - 释放连接
- RAII封装类 `connectionRAII`
- 用户注册/登录SQL语句

---

### 2️⃣ 定时器管理 (8%)

**主要目录**: `src/timer/`, `include/`

**核心文件**:
```
src/timer/
└── timer_list.cpp         ⭐ 定时器链表实现

include/
├── timer_list.h           ⭐ 定时器类定义
└── thread_sync.h          🔧 线程同步工具
```

**重点代码**:
- `sort_timer_lst::add_timer()` - 添加定时器
- `sort_timer_lst::adjust_timer()` - 调整定时器
- `sort_timer_lst::del_timer()` - 删除定时器
- `sort_timer_lst::tick()` - 定时器触发检查
- 升序链表维护
- 超时回调函数

---

### 3️⃣ 项目文档与测试 (7%)

**主要目录**: `docs/`, `tests/`, 根目录

**核心文件**:
```
docs/
├── README.md              ⭐ 主文档 (汇总各模块说明)
├── PROJECT_STRUCTURE.md   ⭐ 项目结构文档
├── QUICKSTART.md          ⭐ 快速开始指南
└── manuals/               📁 手册目录
    ├── webbench.1
    └── webserver.1

根目录文档:
├── README.md              ⭐ 项目总README

tests/
├── benchmark/             ⭐ 性能测试
│   └── webbench-1.5/
└── bin/
    └── webbench           🔧 压测工具
```

**重点工作**:
- 编写/完善各模块README
- 编写快速开始文档
- 功能测试用例
- 协助进行压力测试
- 记录测试数据和结果
- 编写部署文档
- 故障排查文档

---

### 4️⃣ 构建与部署 (6%)

**主要目录**: `scripts/`, 根目录

**核心文件**:
```
根目录:
├── Makefile               ⭐ 主构建文件

scripts/
├── manage.sh              ⭐ 服务管理脚本
├── run_webbench.sh        ⭐ 压测脚本
├── tunnel_ngrok.sh        🔧 内网穿透 (ngrok)
└── tunnel_cloudflared.sh  🔧 内网穿透 (cloudflare)

config/
└── server.conf.example    ⭐ 配置文件示例
```

**重点工作**:
- 优化Makefile编译规则
- 完善manage.sh脚本功能
- 编写一键启动/停止脚本
- 配置日志查看工具
- 压测脚本调试
- 内网穿透脚本配置

---

### 5️⃣ 辅助文档 (4%)

**主要目录**: `docs/`, `packaging/`

**核心文件**:
```
docs/
└── (各模块的详细说明)

packaging/
├── README.md              📝 打包说明
└── debian/                📁 Debian打包文件
    ├── changelog
    ├── control
    ├── copyright
    └── rules

config/
├── server.conf.example    📝 配置示例
└── setup_db.sql           📝 数据库脚本说明
```

**重点工作**:
- 模块级README文档
- 配置文件说明
- 安装依赖文档
- 故障排查指南
- 常见问题FAQ

---

## 🎯 快速定位表

### 你的核心文件清单 (必须掌握)

| 优先级 | 文件路径 | 代码量 | 难度 | 说明 |
|--------|---------|--------|------|------|
| ⭐⭐⭐ | `src/http/http_connection.cpp` | 1500+ | 高 | HTTP解析核心 |
| ⭐⭐⭐ | `src/core/webserver.cpp` | 655 | 高 | 服务器主逻辑 |
| ⭐⭐⭐ | `include/threadpool.h` | 200 | 中 | 线程池模板 |
| ⭐⭐ | `src/log/log.cpp` | 300 | 中 | 日志系统 |
| ⭐⭐ | `resources/webroot/pages/*.html` | - | 中 | 前端页面 |
| ⭐⭐ | `resources/webroot/assets/css/` | - | 低 | 样式设计 |
| ⭐ | `src/core/config.cpp` | 150 | 低 | 配置管理 |
| ⭐ | `include/blocking_queue.h` | 100 | 中 | 阻塞队列 |

**总代码量**: ~3000+ 行核心代码 + 前端页面

---

### 同学的核心文件清单

| 优先级 | 文件路径 | 代码量 | 难度 | 说明 |
|--------|---------|--------|------|------|
| ⭐⭐ | `src/database/database_pool.cpp` | 200 | 中 | 数据库连接池 |
| ⭐⭐ | `src/timer/timer_list.cpp` | 150 | 中 | 定时器管理 |
| ⭐⭐ | `config/setup_db.sql` | 50 | 低 | 数据库脚本 |
| ⭐⭐ | `scripts/manage.sh` | 100 | 低 | 管理脚本 |
| ⭐ | `Makefile` | 150 | 中 | 构建系统 |
| ⭐ | `docs/README.md` | - | 低 | 文档编写 |
| ⭐ | `tests/benchmark/` | - | 低 | 压测辅助 |

**总代码量**: ~800+ 行核心代码 + 文档

---

## 📖 学习路径建议

### 你的学习顺序

1. **第1-2天**: 理解整体架构
   - 阅读 `docs/PROJECT_STRUCTURE.md`
   - 理解 `src/core/main.cpp` 程序入口
   - 跟踪 `src/core/webserver.cpp` 初始化流程

2. **第3-5天**: 深入核心模块
   - 研究 `include/threadpool.h` 线程池实现
   - 分析 `src/http/http_connection.cpp` 状态机
   - 理解 Epoll 事件循环机制

3. **第6-7天**: 日志系统
   - 学习 `include/blocking_queue.h` 阻塞队列
   - 研究 `src/log/log.cpp` 异步日志

4. **第8-10天**: 前端开发
   - 设计页面布局和样式
   - 实现用户交互逻辑
   - 测试各功能页面

5. **第11-12天**: 整合测试
   - 端到端测试
   - 性能优化
   - 准备演示

---

### 同学的学习顺序

1. **第1-2天**: 数据库模块
   - 阅读 `src/database/database_pool.cpp`
   - 编写 `config/setup_db.sql`
   - 测试连接池功能

2. **第3-4天**: 定时器模块
   - 学习 `src/timer/timer_list.cpp`
   - 理解链表维护逻辑
   - 测试超时清理

3. **第5-6天**: 构建系统
   - 优化 `Makefile`
   - 完善 `scripts/manage.sh`
   - 测试一键部署

4. **第7-9天**: 文档编写
   - 完善各模块README
   - 编写测试报告
   - 整理配置说明

5. **第10-12天**: 测试与协助
   - 功能测试
   - 协助压力测试
   - 问题修复

---

## 🔍 关键接口对接

### 需要协调的接口

| 接口 | 你的调用 | 同学的实现 |
|------|---------|-----------|
| 数据库连接 | `http_connection.cpp` 中调用 | `database_pool.cpp` 提供 |
| 定时器管理 | `webserver.cpp` 中调用 | `timer_list.cpp` 提供 |
| 日志记录 | 全局调用 `LOG_INFO/ERROR` | (你负责实现) |
| 前端页面 | `http_connection.cpp` 响应 | (你负责设计) |

---

## 💡 提示

### 你需要特别关注
- ✅ HTTP状态机的正确性
- ✅ Epoll的LT/ET模式切换
- ✅ 线程池的任务调度
- ✅ 异步日志的性能
- ✅ 前端页面的美观性和交互
- ✅ 文件上传功能的完整性

### 同学需要特别关注
- ✅ 数据库连接池的线程安全
- ✅ 定时器链表的正确维护
- ✅ SQL注入防护
- ✅ 构建脚本的健壮性
- ✅ 文档的完整性和准确性
- ✅ 测试用例的覆盖率

---

*生成时间: 2026-01-11*
*项目路径: d:\Network\network\WebServer*
